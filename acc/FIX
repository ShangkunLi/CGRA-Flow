need to make send_en also depend on data rather than only opt_en.
